库在完善中，图片不能显示，还在学习

----

众所周知，B站是一个学习的地方。



需求：在B站看公开课时，网站提供了课程的总时长、合集总集数以及目前看到第几集。但是一方面不同集之间可能时长差别较大，另一方面就我个人而言集数的占比比较抽象，比较希望有一个时间维度上的总进度条

效果如下：![](

想直接使用的同学可在`v5_tampermonkey`文件里的`.js`代码直接复制到油猴的新脚本里，油猴会在你打开B站合集类的视频时自动运行

> 只想使用但是对油猴也不了解的同学可以简单的查一下，油猴相对操作简单

-----

开发过程见下（具体代码及注释说明见对应文件）

1. `v1_C++`：

   + 原理：手动将看过的视频的时间输入到特定的文件，运行程序中进行计算

     > 极其傻瓜，奈何当时极菜

   + 缺点：每看过一个视频还要手动输入一下，只是用计算机代替人脑的计算过程

2. `v2_Python_OCR`：

   + > OCR是一种图像识别技术，谷歌的tesseract实现了这些功能，pytesseract是python对它的接口

     每看过几个视频，想要看过的时间，将看过的视频的时间（B站合集分P右部分有显示）截屏保存，利用python的图像识别识别出内容再计算

   + 缺点：截屏也比较麻烦，还有记录看到那里，而且这终究需要人输入

3. `v3_Python_WebSpide`：

   > 这期间我学习了网络爬虫，打开了B站合集的源代码，发现合集里每个分P都在源代码中显示：![]( 其中标记记为时间（单位为秒)

4. `v4_JavaScript`：

   > 网页？前端三件套才是根正苗红呀
   >
   > > 截至到2022.3.16的认知：
   > >
   > > + Js负责逻辑——可以实现我的目的
   > > + 其语法类似Java——也许我可以即使没有学过也能开发出来
   >
   > 于是我决定放弃爬虫选用js写

   + 原理：对于视频右边的分P栏

     1. 含有(正在看的视频索引/总视频数量)的对象类名为`'cur-page'`
     2. 含有每个视频的信息的元素对象名为`'duration[]'`，通过索引获得每集的显示信息

     通过正则表达式获取需要的信息

   + 缺点：现在的工作流是在看的视频中点击F12打开开发模式，在console中复制进入js代码，还需要人操作

5. `v5_tampermonkey`：想要自动运行可以利用浏览器的插件，至于为什么没有自定义插件而是在油猴中开发可见具体文件内的说明

   + 原理：与v4版本类似，问题在于在console中整个网站已经加载完毕，但是插件的运行时间和打开网页一同进行，这里要做定时操作
   + 在打开B站合集的时候自动弹出标签，且不影响原页面的使用，一点点别扭的是在切换分P时的更新方案。

# 鸣谢

+ 代码主要借鉴这两位前辈的代码

  + 逻辑：https://www.52pojie.cn/thread-1517520-1-1.html
  + 显示方案：[https://greasyfork.org/zh-CN/scripts/431734-哔哩哔哩工具-快捷键-视频时长](https://greasyfork.org/zh-CN/scripts/431734-%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E5%B7%A5%E5%85%B7-%E5%BF%AB%E6%8D%B7%E9%94%AE-%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BF)

  侵删。

+ 在开发过程中特别是关于Javascript的问题受到学校学长的很多帮助

在此一并表示感谢
